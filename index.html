<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Henglin Li">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
<link href='/assets/stylesheets/bootstrap.min-e0e2914ec503fd07e90c90bb71395057.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/style-e81fa375b231bedf6cb2dbc6653570cc.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/google_prettify/sons-of-obsidian-afb0925bfa2d994f17dab93e13fbf999.css' type='text/css' rel='stylesheet' media='all'>
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">henglinli.github.io</a>
          <ul class="nav">
              
                <li><a href="/archive">Archive</a></li>
              
              
                <li><a href="/tags">Tags</a></li>
              
              
                <li><a href="/categories">Categories</a></li>
              
              
                <li><a href="/pages">Pages</a></li>
              
              
                <li><a href="/about">About Me</a></li>
              
          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        <div class="page-header">
  <h1>Home </h1>
</div>

<div class="row-fluid">
  <div class="span12">
    <div class="post">
  <h3 class="title"><a href="/try/try-concurrency-kit-and-tbb">try Concurrency Kit and TBB</a> <span class="date">2013-12-05</span></h3>

  <div class="summary ellipsis">
<h3 id="toc_0">Why</h3>

<p>Server&#31471;&#38656;&#35201;&#19968;&#20010;&#20840;&#23616;&#23481;&#22120;&#65292;&#26469;&#23384;&#25918;&#20840;&#37096;Client&#30340;&#24403;&#21069;&#29366;&#24577;&#65292;&#20197;&#20415;&#33021;&#20570;&#21040;C2C&#20132;&#20114;&#65307;
&#20063;&#38656;&#35201;&#22810;&#20010;&#20840;&#23616;&#23481;&#22120;&#26469;&#20445;&#25345;Server&#30340;&#29366;&#24577;&#20449;&#24687;&#65292;&#20197;&#20415;&#33021;&#20570;&#21040;C2S&#20132;&#20114;&#12290;&#22810;&#32447;&#31243;&#19979;&#65292;
&#20351;&#29992;&#24120;&#35268;&#23481;&#22120;(unorderd_map&#31561;)&#24471;&#19978;&#38145;&#65292;&#36825;&#26679;Server&#23601;&#24930;&#19979;&#26469;&#20102;&#12290;</p>

<h2 id="toc_1">How</h2>

<p><a href="http://concurrencykit.org/" title="Concurrency Kit">Concurrency Kit</a>&#25552;&#20379;&#22810;&#31181;&#26080;&#38145;(lockfree)&#23481;&#22120;&#65292;
<a href="http://threadingbuildingblocks.org" title="Intel&reg; Threading Building Blocks (Intel&reg; TBB)">Intel&reg; Threading Building Blocks (Intel&reg; TBB)</a>&#20063;&#25552;&#20379;&#24182;&#21457;&#30340;&#23481;&#22120;&#65292;
<a href="http://threadingbuildingblocks.org" title="Intel&reg; Threading Building Blocks (Intel&reg; TBB)">Intel&reg; TBB</a>&#30340;&#24182;&#21457;&#23481;&#22120;&#20063;&#19981;&#26159;&#26080;&#38145;&#23481;&#22120;&#65292;&#29702;&#35770;&#19978;&#35201;&#27604;<a href="http://concurrencykit.org/" title="Concurrency Kit">Concurrency Kit</a>&#24930;&#12290;
&#37319;&#29992;&#20197;&#19979;&#19977;&#31181;hash map:</p>

<pre><code>    // &#24102;&#19968;&#20010;std::mutex&#38145;&#30340;std::unorderd_map
    class MutexHashMap {
        std::unorderd_map&lt;int, void*&gt; hash_map_;
        std::mutex mutex_;
    }; 
    // (Intel&reg; TBB)&#30340;&#24182;&#21457;hash map
    using TBBHashMap = tbb::interface5::concurrent_hash_map&lt;int, void*&gt;;
    // Concurrency Kit&#30340;&#26080;&#38145;hash map
    struct ck_ht_t hash_table_;
</code></pre>
</div>

  <div class="more">
    <a href="/try/try-concurrency-kit-and-tbb" class="btn btn-small">read more..</a>
  </div>
</div>
<div class="post">
  <h3 class="title"><a href="/study/boost-asio-%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E8%AE%BE%E8%AE%A1">Boost.Asio 连接池的设计</a> <span class="date">2013-12-02</span></h3>

  <div class="summary ellipsis">
<h3 id="toc_0">Introduction</h3>

<p>&#32593;&#36335;&#32534;&#31243;&#19977;&#20010;&#27744;&#65306;&#20869;&#23384;&#27744;&#65292;&#32447;&#31243;&#27744;&#21644;&#38142;&#25509;&#27744;&#12290;&#20869;&#23384;&#27744;&#26377;<a href="http://www.boost.org/doc/libs/release/libs/pool/%E2%80%8E" title="Boost.Pool">Boost.Pool</a>,&#20294;&#26159;&#23427;&#26377;&#24322;&#24120;&#65307;
<a href="https://code.google.com/p/gperftools/" title="gperftools">google gperftools</a>&#21644;<a href="https://github.com/emeryberger/Hoard" title="hoard allocator">Hoard</a>&#21602;&#65292;&#20182;&#20204;&#21448;&#24037;&#20316;&#22312;override&#27169;&#24335;&#19979;(<a href="http://henglinli.github.io/try/try-tcmalloc/" title="try tcmalloc">&#20197;&#21069;&#25552;&#21040;&#30340;</a>
&#26041;&#27861;&#24212;&#35813;&#33021;&#20570;&#21040;&#30452;&#25509;&#35843;&#29992;tcmalloc)&#65307;&#20854;&#23454;&#65292;&#20570;&#20010;<a href="http://en.wikipedia.org/wiki/Free_list" title="free list">Free list</a>&#25110;&#32773;
<a href="https://github.com/facebook/folly/blob/master/folly/Arena.h" title="facebook folly arena">Facebook Folly Arena</a>&#20063;&#23601;&#22815;&#29992;&#20102;&#12290;&#32447;&#31243;&#27744;&#65292;&#29992;<a href="http://www.boost.org/doc/libs/release/libs/asio/%E2%80%8E" title="Boost.Asio">Boost.Asio</a>&#30340;&#35805;&#20063;&#24456;&#31616;&#21333;
(<a href="http://www.boost.org/doc/libs/1_55_0/doc/html/boost_asio/example/cpp03/http/server3/request_handler.cpp" title="asio threadpool exmaple">&#35265;&#27492;</a>)&#65292;&#33258;&#24049;&#23454;&#29616;&#30340;&#35805;&#29992;&ldquo;&#26465;&#20214;&#21464;&#37327;&rdquo;&#38459;&#22622;&#23601;&#26377;&#20102;Master-worker&#12290;&#36830;&#25509;&#27744;&#65292;&#25105;&#19968;&#30452;&#19981;&#35299;&#65306;
socket fd &#19981;&#33021;&#22238;&#25910;&#21543;&#65311;&#25105;&#29702;&#35299;&#30340;&#36830;&#25509;&#27744;&#25110;&#32773;session&#26159;&#25351;: &#35835;&#20889;buffer&#65292;&#23458;&#25143;&#31471;&#26631;&#35782;&#31561;&#65292;&#23545;&#24212;&#21040;&#23458;&#25143;&#31471;&#30340;&#30456;&#21516;&#31867;&#21035;&#30340;&#20849;&#21516;&#25968;&#25454;&#12290;</p>

<h3 id="toc_1">Why</h3>

<p>&#25105;<code>&#20010;&#20154;&#21333;&#26041;&#38754;&#22320;</code>&#29702;&#35299;&#20026;&#21160;&#24577;&#20869;&#23384;&#20998;&#37197;&#24456;&#24930;&#65281;&#25152;&#20197;&#25105;&#24819;&#35201;&#27744;&#21270;&#37027;&#20123;&#33021;&#39044;&#36873;&#20998;&#37197;&#20869;&#23384;&#30340;&#37096;&#20998;&#12290;
&#65288;&#20851;&#20110;&#20248;&#21270;&#30340;&#29702;&#35299;&#25105;&#24819;&#21333;&#29420;&#20889;&#20986;&#26469;&#12290;)</p>

<h3 id="toc_2">&#39318;&#20808;&#24819;&#21040;&#30340;</h3>

<p>&#25105;&#39318;&#20808;&#24819;&#21040;&#30340;&#26159;&#65306;<a href="http://en.wikipedia.org/wiki/Free_list" title="free list">Free list</a>&#27861;&#12290;session&#24212;&#35813;&#26159;&#21487;&#20197;&#30830;&#23450;&#22823;&#23567;&#30340;&#65293;&#65293;&#21327;&#35758;&#20013;&#30340;&#26368;&#22823;&#20256;&#36755;&#22359;&#21152;&#20854;&#20182;&#22266;&#26377;&#25968;&#25454;&#21363;&#26159;&#12290;
&#24403;&#28982;&#27599;&#27425;&#21160;&#24577;&#20869;&#23384;&#20998;&#37197;&#19981;&#33021;&#26159;session&#22823;&#23567;&#65292;<a href="https://code.google.com/p/gperftools/" title="gperftools">tcmalloc</a> &#35748;&#20026;&#22359;64k&#26159;&#21512;&#36866;&#30340;&#12290;&#28982;&#21518;&#35201;&#27880;&#24847;&#30340;&#26159;[Boost.Asio]&#30340;socket&#26159;&#38750;&#24179;&#20961;&#30340;(non-trivial),&#36825;&#20010;&#19979;&#38754;&#20063;&#20250;&#35762;&#21040;&#12290;&#20889;&#20986;&#26469;&#22823;&#27010;&#26159;&#36825;&#26679;&#30340;&#65306;</p>

<pre><code>    template&lt;typename HandlerType&gt; // read/write &#22312;handler&#20013;&#36827;&#34892;
    class CachedSession {          // &#19968;&#31995;&#21015;&#30340;&#35835;&#20889;&#23601;&#26159;&#21327;&#35758;
    public:
        using socket = asio::ip::tcp::socket;
        ~CachedSession() = default; //&#40664;&#35748;&#23601;&#34892;
        // io_service&#29992;&#26469;&#26500;&#36896;socket&#65307;&#20808;&#26597;freelist&#65292;&#27809;&#26377;&#23601;&#21160;&#24577;&#20998;&#37197;&#20869;&#23384; 
        static CachedSession* Create(asio::io_service service);
        socket&amp; Socket(); // &#29992;&#26469;Accept
        void Start(); //  call hanler&#65292;handler read/write
        void Stop(); // handler done, call it;
        static StopAll(); // &#28165;&#38500;&#38142;&#25509;&#65292;&#22238;&#25910;&#25152;&#26377;&#20869;&#23384;
    protected:
        // &#22312;Create&#20013;&#29992; placement new(the_cached_session_momery) CachedSession(service)&#26500;&#36896;
        explicit CachedSession(asio::io_service service);
    private:
        CachedAlloc&lt;CachedSession&gt; allocator_; // &#19968;&#20010;Arena
        // &#31354;&#38386;&#30340;session&#21015;&#34920;&#65292;&#24403;&#28982;&#21482;&#26159;&#36825;&#20010;&#24847;&#24605;&#65292;Boost.Intrusive&#29992;&#36215;&#26469;&#26356;&#22797;&#26434;
        boost::intrusive::list&lt;CachedSession&gt; free_list_; 
        // client &#21015;&#34920;&#20102;&#65292;&#29992;list&#21482;&#26159;&#34920;&#24847;&#65292;&#20855;&#20307;&#29992;&#37027;&#31181;&#26641;&#25110;hash&#65292;
        // Boost.Intrusive&#30340;&#36873;&#25321;&#22826;&#22810;&#20102;...
        boost::intrusive::list&lt;CachedSession&gt; active_list_; 
        socket socket_; // socket &#22312;Create
        char recv_buffer_[2048];
        char send_buffer_[2048];
        int id_;
        // ...
    }
</code></pre>
</div>

  <div class="more">
    <a href="/study/boost-asio-%E8%BF%9E%E6%8E%A5%E6%B1%A0%E7%9A%84%E8%AE%BE%E8%AE%A1" class="btn btn-small">read more..</a>
  </div>
</div>
<div class="post">
  <h3 class="title"><a href="/tutorial/botan-srp-%E4%BD%BF%E7%94%A8%E4%BE%8B%E5%AD%90">Botan SRP 使用例子</a> <span class="date">2013-11-21</span></h3>

  <div class="summary ellipsis">
<h3 id="toc_0">&#20026;&#31070;&#39532;Botan SRP&#65311;</h3>

<ul>
<li>
<a href="http://botan.randombit.net/" title="botan home">Botan</a> is a crypto library for C++ released under the permissive <a href="http://botan.randombit.net/license.html" title="botan license">BSD-2 (or FreeBSD) license</a>. C++&#21644;BSD&#31995;&#21015;&#30340;license&#23601;&#26159;&#26368;&#22909;&#30340;&#29702;&#30001;&#65292;&#23427;&#29992;&#20102;&#24322;&#24120;&#65292;&#25105;&#34920;&#31034;&#38750;&#24120;&#36951;&#25022;&#12290;</li>
<li>
<a href="http://en.wikipedia.org/wiki/Secure_Remote_Password_protocol" title="srp wiki">SRP(Secure Remote Password protocol)</a>&#19968;&#30475;&#21517;&#23383;&#23601;&#30693;&#36947;&#65292;
&#23427;&#27604;&#26381;&#21153;&#31471;&#20445;&#23384;hash&#23494;&#30721;&#23433;&#20840;&#22810;&#20102;&#12290;</li>
</ul>

<h3 id="toc_1">&#35299;&#37322;</h3>

<ul>
<li><p><a href="http://botan.randombit.net/" title="botan home">Botan</a>&#30340;SRP&#23454;&#29616;&#26159;<a href="http://tools.ietf.org/html/rfc5054" title="RFC 5054">RFC 5054</a>SRP-TLS&#65292;&#23427;&#21644;<a href="http://tools.ietf.org/html/rfc2945" title="RFC 2945">RFC 2945</a>(<a href="http://www.cnpaf.net/rfc/rfc2945.txt" title="RFC 2945 &#20013;&#25991;">&#20013;&#25991;</a>)&#19981;&#22826;&#19968;&#26679;&#12290;</p></li>
<li><p><a href="http://botan.randombit.net/" title="botan home">Botan</a>&#30340;SRP&#32473;&#20010;3&#20010;&#20989;&#25968;&#19968;&#20010;&#31867;&#65288;2&#20010;&#20989;&#25968;&#65289;&#20849;5&#20010;&#25509;&#21475;&#12290;</p></li>
<li>
<p>&#23458;&#25143;&#31471;&#20989;&#25968;</p>

<pre><code>// &#39564;&#35777;&#26381;&#21153;&#22120;&#31471;&#21457;&#36865;&#26469;&#30340;B&#65292;&#24182;&#36820;&#22238;&#23458;&#25143;&#31471;key
std::pair&lt;BigInt,SymmetricKey&gt; // &#36820;&#22238; A &#21644; client key
BOTAN_DLL srp6_client_agree(
  const std::string&amp; username, // &#29992;&#25143;&#21517;
  std::string&amp; password, // &#23494;&#30721;&#65292;&#19981;&#20250;&#36890;&#36807;&#32593;&#32476;&#20256;&#36755;
  const std::string&amp; group_id, // &#26684;&#24335;&#20026;"modp/srp/1024", 1024&#34920;&#31034;1024&#20301;&#25968;
  const std::string&amp; hash_id, // &#26684;&#24335;&#20026;"MD-5" "SHA-160"&#31561;
  const std::vector&lt;byte&gt;&amp; salt, // &#26368;&#23569;128&#20301;&#65292;&#30001;&#26381;&#21153;&#22120;&#31471;&#24471;&#21040;
  const BigInt&amp; B, // &#26381;&#21153;&#22120;&#31471;&#36820;&#22238;&#30340;B
  RandomNumberGenerator&amp; rng); // &#21487;&#29992;Botan::AutoSeeded_RNG
</code></pre>
</li>
<li>
<p>&#26381;&#21153;&#22120;&#31471;&#20989;&#25968;</p>

<pre><code>// &#27880;&#20876;&#29992;&#65292;&#29983;&#25104;&lt;username, verifier, salt&gt;&#19977;&#20803;&#32452;&#20013;&#30340;verifier,
// &#38656;&#25345;&#20037;&#21270;&#35813;&#19977;&#20803;&#32452;
BigInt 
generate_srp6_verifier(
  const std::string&amp; identifier, // &#29992;&#25143;&#21517;
  const std::string&amp; password, // &#23494;&#30721;&#65292;&#25110;&#23494;&#30721;hash
  const std::vector&lt;byte&gt;&amp; salt, // &#38543;&#26426;&#29983;&#25104;&#65292;&#26368;&#23569;128&#20301;
  const std::string&amp; group_id, // &#24517;&#39035;&#21644;&#23458;&#25143;&#31471;&#19968;&#33268;
  const std::string&amp; hash_id); // &#24517;&#39035;&#21644;&#23458;&#25143;&#31471;&#19968;&#33268;
</code></pre>
</li>
<li>
<p>&#26381;&#21153;&#22120;&#31471;&#31867;</p>

<pre><code>class SRP6_Server_Session
{
public:
// &#29983;&#25104; B
BigInt // &#36820;&#22238;B&#65292;B&#35201;&#20256;&#36865;&#32473;&#23458;&#25143;&#31471;
step1(const BigInt&amp; v, // &#25345;&#20037;&#21270;&#19977;&#20803;&#32452;&#20013;&#30340;verifier
      const std::string&amp; group_id, // &#24517;&#39035;&#21644;&#23458;&#25143;&#31471;&#19968;&#33268;
      const std::string&amp; hash_id, // &#24517;&#39035;&#21644;&#23458;&#25143;&#31471;&#19968;&#33268;
      RandomNumberGenerator&amp; rng); // &#24517;&#39035;&#21644;&#23458;&#25143;&#31471;&#19968;&#33268;

// &#36820;&#22238;&#26381;&#21153;&#22120;key
SymmetricKey step2(const BigInt&amp; A); // &#23458;&#25143;&#31471;&#20256;&#36865;&#26469;&#30340;A
};
</code></pre>
</li>
<li>
<p>helper&#20989;&#25968;</p>

<pre><code>// &#26242;&#26102;&#27809;&#29992;&#21040;
std::string srp6_group_identifier(const BigInt&amp; N, const BigInt&amp; g);
</code></pre>
</li>
</ul>
</div>

  <div class="more">
    <a href="/tutorial/botan-srp-%E4%BD%BF%E7%94%A8%E4%BE%8B%E5%AD%90" class="btn btn-small">read more..</a>
  </div>
</div>
<div class="post">
  <h3 class="title"><a href="/try/try-tcmalloc">try tcmalloc</a> <span class="date">2013-11-07</span></h3>

  <div class="summary ellipsis">
<h3 id="toc_0">Why</h3>

<p><a href="https://code.google.com/p/gperftools/" title="gperftools">TCMalloc</a>&#24456;&#26089;&#23601;&#29609;&#36807;&#20102;&#65292;&#26368;&#36817;&#38754;&#35797;&#65292;&#35752;&#35770;&#21040;&#20851;&#20110;&#31243;&#24207;&#20248;&#21270;&#30340;&#38382;&#39064;&#65292;
&#24403;&#26102;&#34987;&#36924;&#38382;&#31639;&#27861;&#21644;&#25968;&#25454;&#32467;&#26500;&#65292;&#25105;&#30340;&#22238;&#31572;&#26159;&#65306;&#29992;&#24120;&#29992;&#30340;&#23601;&#34892;&#65292;&#32534;&#35793;&#22120;&#20250;&#33258;&#21160;&#20248;&#21270;&#30340;&#65292;
&#26368;&#20027;&#35201;&#30340;&#26159;&#20943;&#23569;&#31995;&#32479;&#35843;&#29992;&#12290;&#29616;&#22312;&#24819;&#26469;&#65292;&#26368;&#26089;&#24212;&#35813;&#32771;&#34385;&#30340;&#26159;&#20248;&#21270;&#20869;&#23384;&#20351;&#29992;&#65292;
&#21363;&#26367;&#25442;&#31995;&#32479;&#40664;&#35748;&#30340;&#20869;&#23384;&#20998;&#37197;&#22120;&#25110;&#20351;&#29992;&#20869;&#23384;&#27744;&mdash;&mdash;
&#20351;&#29992;<a href="https://code.google.com/p/gperftools/" title="gperftools">TCMlloc</a>&#25110;<a href="www.boost.org/libs/pool/%E2%80%8E" title="boost pool">Boost.Pool</a>&#12290;</p>

<h3 id="toc_1">How</h3>

<p>&#19968;&#24320;&#22987;&#21482;&#30693;&#36947;<a href="https://code.google.com/p/gperftools/" title="gperftools">TCMalloc</a>&#25226;&#20869;&#23384;&#20998;&#37197;&#30340;&#20107;&#24773;&#32454;&#21270;&#20102;&#65306;
&#23567;&#30340;&#20869;&#23384;&#20998;&#37197;&#29992;&#32447;&#31243;&#26412;&#22320;h&#32531;&#23384;(thread-local cache);
&#22823;&#30340;&#20869;&#23384;&#20998;&#37197;&#29992;&#20027;&#32531;&#23384;&#22534;(central headp)&#20998;&#37197;;
&#20998;&#37197;&#30340;&#20869;&#23384;&#21487;&#22312;&#20004;&#32773;&#30452;&#25509;&#36716;&#31227;&#12290;&#29616;&#22312;&#25165;&#30693;&#36947;&#30340;&#26159;&#23427;&#26159;&#24590;&#20040;&#26367;&#20195;&#31995;&#32479;
&#33258;&#24102;&#30340;&#20998;&#37197;&#22120;&#30340;&#65306;</p>

<p>1, GNU/Linux with glibc 
&#35828;&#26469;&#24813;&#24871;&#65292;&#19968;&#24320;&#22987;&#25105;&#20197;&#20026;<a href="http://www.gnu.org/software/libc/manual/html_node/Hooks-for-Malloc.html" title="tls">malloc hook</a>&#23601;&#26159;&#26469;&#24178;&#36825;&#20107;&#30340;&#65292;
&#20180;&#32454;&#30475;&#20102;&#25991;&#26723;&#21457;&#29616;<a href="http://www.gnu.org/software/libc/manual/html_node/Hooks-for-Malloc.html" title="tls">&#23427;</a>&#26159;&#29992;&#26469;debug&#30340;&#12290;
&#30475;&#20102;<a href="https://code.google.com/p/gperftools/source/browse/src/libc_override_gcc_and_weak.h" title="glibc override">tcmalloc&#30340;&#30456;&#20851;&#20195;&#30721;</a>&#21457;&#29616;&#29992;&#30340;&#26159;<a href="http://en.wikipedia.org/wiki/Weak_symbol" title="weak symbol">Weak Symbol</a>alias&#12290;</p>

</div>

  <div class="more">
    <a href="/try/try-tcmalloc" class="btn btn-small">read more..</a>
  </div>
</div>
<div class="post">
  <h3 class="title"><a href="/try/try-os-x-static-link">Try OS X static link</a> <span class="date">2013-08-21</span></h3>

  <div class="summary ellipsis">
<h3 id="toc_0">&#24320;&#22987;</h3>

<p>&#30001;&#20110;clang&#40664;&#35748;&#30340;c++&#26631;&#20934;&#24211;&#36824;&#26159;libstdc++,&#25105;&#23601;&#24819;&#35013;gcc-4.8,&#38500;&#20102;&#32593;&#32476;&#38382;&#39064;&#22806;&#36824;&#31639;&#39034;&#21033;&#65306;</p>

<pre><code>brew tap homebrew/versions
brew install gcc48
</code></pre>

<p>&#20809;&#26159;&#32534;&#35793;gcc&#23613;&#28982;&#32791;&#26102;47&#20998;&#38047;&#65281;&#23433;&#35013;&#20043;&#21518;&#27979;&#35797;&#19979;&#65306;</p>

<pre><code>int main() { return 0; } // empty.cc
gcc-4.8 empty.cc // OK
gcc-4.8 empty.cc -static // ld: library not found for -lcrt0.o
</code></pre>

<p>&#25214;&#19981;&#21040;crt0.o, &#37027;&#23612;&#65311;</p>

<h3 id="toc_1">&#32487;&#32493;</h3>

<p>&#22312;/usr/lib/&#21644;Xcode&#30340;SDK&#20013;&#37117;&#27809;&#26377;&#25214;&#21040;&#23427;&#65292;&#20110;&#26159;google&#20102;&#19968;&#19979;&#21457;&#29616;&#20102;<a href="https://developer.apple.com/library/mac/qa/qa1118/_index.html" title="qa crt0.o">Apple&#30340;Technical Q&amp;A QA1118</a>,&#23427;&#36824;&#35828;&#25945;&#20102;&#19968;&#30058;&#65292;&#28982;&#21518;&#35828;&#19981;&#25903;&#25345;&#38745;&#24577;&#38142;&#25509;(Apple does not support statically linked binaries on Mac OS X.), &#20294;&#26159;&#23427;&#32473;&#20986;&#20102;&#26041;&#21521;&#65292;&#35753;&#25105;&#20204;&#33258;&#24049;&#32534;&#35793;<em>Csu (C starup)</em>&#12290;&#19979;&#36733; <a href="http://www.opensource.apple.com/tarballs/Csu/Csu-79.tar.gz">http://www.opensource.apple.com/tarballs/Csu/Csu-79.tar.gz</a> &#24182;&#19988;&#32534;&#35793;:</p>

</div>

  <div class="more">
    <a href="/try/try-os-x-static-link" class="btn btn-small">read more..</a>
  </div>
</div>

<div class="pagination">
  <ul>
      <li class="active"><a href="/">1</a></li>
      <li><a href="/posts/index/2">2</a></li>
  </ul>
</div>
  </div>
</div>

      </div>

      <hr>
      <div class="footer">
        <p>&copy; Henglin Li 2013
          with help from <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </div>

    </div> <!-- /container -->

    <!-- Google Prettify -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint linenums";
  }
  prettyPrint();
</script>
<!-- end Google Prettify -->
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-42955283-1']);
  _gaq.push(['_trackPageview']);
  

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


    
  </body>
</html>
